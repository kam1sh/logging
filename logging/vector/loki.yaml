api:
  enabled: true
  address: 0.0.0.0:8686

sinks:
  loki:
    inputs:
      - feeder
      - statistics
      - storage
    type: loki
    endpoint: "http://loki:3100"
    compression: snappy
    out_of_order_action: accept
    encoding:
      codec: json
    labels:
      job: vector
      service: "{{ service }}"
    acknowledgements:
      enabled: true
    buffer:
      type: disk
      max_size: 1073741952

sources:
  feeder_f:
    type: file
    read_from: beginning
    include:
    - /logs/feeder.log
  storage_f:
    type: file
    read_from: beginning
    include:
    - /logs/storage-uwsgi.log
  statistics_f:
    type: file
    read_from: beginning
    include:
    - /logs/statistics.log
transforms:
  feeder:
    type: remap
    inputs:
    - feeder_f
    source: |
      .service = "feeder"
  statistics:
    type: remap
    inputs:
    - statistics_f
    source: |
      .service = "statistics"
  storage:
    type: remap
    inputs:
    - storage_f
    source: |
      .service = "storage"
